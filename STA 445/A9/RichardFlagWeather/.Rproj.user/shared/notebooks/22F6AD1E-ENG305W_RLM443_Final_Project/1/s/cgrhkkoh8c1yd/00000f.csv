"0","lm_eqn <- function(df){"
"0","    m <- lm(dream.quality ~ dream.recall, df);"
"0","    eq <- substitute(italic(y) == a + b %.% italic(x)*"",""~~italic(r)^2~""=""~r2, "
"0","         list(a = format(unname(coef(m)[1]), digits = 2),"
"0","              b = format(unname(coef(m)[2]), digits = 2),"
"0","             r2 = format(summary(m)$r.squared, digits = 3)))"
"0","    as.character(as.expression(eq));"
"0","}"
"0",""
"0","ggplot( data=dream.data, aes( x=dream.quality, y=dream.recall ) ) +"
"0","  geom_smooth( method=""lm"" ) +"
"0","  geom_point( aes( x=dream.quality,"
"0","                   y=dream.recall ) ) +"
"0","  labs( title=""Dream Quality vs. Dream Recall"","
"0","        x=""Dream Quality"", y=""Dream Recall"" ) + "
"0","  geom_text(x = 3, y = 5, label = lm_eqn(dream.data), parse = TRUE) +"
"0","  geom_count( aes( size=after_stat( n ), color=after_stat( n ) ) ) +"
"0","  theme( legend.position = ""none"" )"
