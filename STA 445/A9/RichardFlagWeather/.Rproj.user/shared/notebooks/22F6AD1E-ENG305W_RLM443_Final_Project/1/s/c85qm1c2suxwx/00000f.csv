"0","lm_eqn <- function(df){"
"0","    m <- lm(dream.quality ~ dream.duration, df);"
"0","    eq <- substitute(italic(y) == a + b %.% italic(x)*"",""~~italic(r)^2~""=""~r2, "
"0","         list(a = format(unname(coef(m)[1]), digits = 2),"
"0","              b = format(unname(coef(m)[2]), digits = 2),"
"0","             r2 = format(summary(m)$r.squared, digits = 3)))"
"0","    as.character(as.expression(eq));"
"0","}"
"0",""
"0","dream.quality.time <- ggplot( data=dream.data ) +"
"0","  geom_smooth( method=""lm"", "
"0","               aes( x=dream.duration,"
"0","                    y=dream.quality ) ) +"
"0","  geom_point( aes( x=dream.duration,"
"0","                   y=dream.quality ) ) +"
"0","  labs( title=""Dream Duration vs. Dream Quality"","
"0","        x=""Dream Duration"", y=""Dream Quality"" ) + "
"0","  geom_text(x = 3, y = 5.5, label = lm_eqn(dream.data), parse = TRUE) + "
"0","  geom_count( aes( x=dream.duration, y=dream.quality, "
"0","                   size=after_stat( n ), color=after_stat( n ) ) ) +"
"0","  theme( legend.position = ""none"" )"
"0","  "
"0","dream.quality.time"
