"0","time.quality.model = lm( dream.data$Sleep.Quality ~ dream.data$Sleep.Time )"
"0",""
"0","lm_eqn <- function(df){"
"0","    m <- lm(Sleep.Quality ~ Sleep.Time, df);"
"0","    eq <- substitute(italic(y) == a + b %.% italic(x)*"",""~~italic(r)^2~""=""~r2, "
"0","         list(a = format(unname(coef(m)[1]), digits = 2),"
"0","              b = format(unname(coef(m)[2]), digits = 2),"
"0","             r2 = format(summary(m)$r.squared, digits = 3)))"
"0","    as.character(as.expression(eq));"
"0","}"
"0",""
"0",""
"0",""
"0","quality.time.plot <- ggplot( data=dream.data, "
"0","                             aes( x=Sleep.Time, y=Sleep.Quality ) ) +"
"0","  geom_smooth( method=""lm"" ) +"
"0","  geom_point( ) +"
"0","  labs( title=""Sleep Duration vs. Sleep Quality"","
"0","        x=""Time Slept (Hours)"", y=""Sleep Quality"" ) + "
"0","  geom_text(x = 4, y = 5, label = lm_eqn(dream.data), parse = TRUE) +"
"0","  geom_count( aes( size=after_stat( n ), color=after_stat( n ) ) ) +"
"0","  theme( legend.position = ""none"" )"
"0",""
"0","quality.time.plot"
